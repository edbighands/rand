CREATE TABLE DM_ROOMS
(

ROOM_CAT_ID INTEGER,
ROOM_CATEGORY VARCHAR2(4000),
ROOM_SIZE VARCHAR2(50),
ROOM_AMENITIES VARCHAR2(4000),
ROOM_SOUTH_FACING VARCHAR2(1),
ROOM_HILL_VALLEY_FACING VARCHAR2(1),
ROOM_IS_DUPLEX VARCHAR2(1)


);


ALTER TABLE DM_ROOMS ADD CONSTRAINT PK_DM_ROOMS PRIMARY KEY (ROOM_CAT_ID);

CREATE TABLE DM_BOOK_SLOTS
(

SLOTS_ID INTEGER,
SLOTS_CATEGORY VARCHAR2(4000),
SLOTS_TIME VARCHAR2(50)


);
ALTER TABLE DM_BOOK_SLOTS ADD CONSTRAINT PK_DM_BOOK_SLOTS PRIMARY KEY (SLOTS_ID);

CREATE TABLE DM_PRICE_PROMOTIONS
(

ROOM_PROMO_ID INTEGER,
PROMO_ID INTEGER,
PROMO_CATEGORY VARCHAR2(4000),
PROMO_DISC NUMBER(7,2)



);

ALTER TABLE DM_PRICE_PROMOTIONS ADD CONSTRAINT PK_DM_PRICE_PROMOTIONS PRIMARY KEY (PROMO_ID,ROOM_PROMO_ID);


CREATE TABLE F_ROOMS_BASE_PRICE
(

ROOM_PRICE_BASE_ID INTEGER,
ROOM_PRICE_BASE_VALUE NUMBER(7,2),
ROOM_TYPE_ID INTEGER,
ROOM_SLOTS_ID INTEGER


);
ALTER TABLE F_ROOMS_BASE_PRICE ADD CONSTRAINT PK_F_ROOMS_BASE_PRICE PRIMARY KEY (ROOM_PRICE_BASE_ID);





CREATE VIEW V_ROOMS_DISPLAY
(

ROOM_TYPE,ROOM_SIZE,AMENITIES,IS_SOUTH_FACING,IS_HILL_VIEW,IS_DUPLEX,RESERVATION_TYPE,RESERVATION_TIME,PRICE_WITHOUT_OFFERS

)

as

select DIM_ROOM.ROOM_CATEGORY,DIM_ROOM.ROOM_SIZE,DIM_ROOM.ROOM_AMENITIES,DIM_ROOM.ROOM_SOUTH_FACING,DIM_ROOM.ROOM_HILL_VALLEY_FACING,DIM_ROOM.ROOM_IS_DUPLEX,
DIM_SLOTS.SLOTS_CATEGORY,DIM_SLOTS.SLOTS_TIME,
DIM_INFO.ROOM_PRICE_BASE_VALUE

from

DM_ROOMS as DIM_ROOM,
DM_BOOK_SLOTS as DIM_SLOTS,
F_ROOMS_BASE_PRICE as DIM_INFO

where
DIM_INFO.ROOM_TYPE_ID = DIM_ROOM.ROOM_CAT_ID
and
DIM_INFO.ROOM_SLOTS_ID = DIM_SLOTS.SLOTS_ID;

CREATE TABLE USER_RATING_TRANS
(

USER_ID INTEGER,
ROOM_CAT_ID INTEGER,
ROOM_RATING INTEGER

);
ALTER TABLE USER_RATING_TRANS ADD CONSTRAINT PK_USER_RATING_TRANS PRIMARY KEY (USER_ID,ROOM_CAT_ID);

CREATE TABLE ROOM_RESERVATION_OLTP
(

RESERVATION_ID INTEGER,
USER_ID INTEGER,
ROOM_CAT_ID INTEGER,
SLOTS_ID INTEGER,
PROMO_APPLIED VARCHAR2(200),
FINAL_PRICE NUMBER(7,2),
RESERVATION_DATE DATE


);
ALTER TABLE ROOM_RESERVATION_OLTP ADD CONSTRAINT PK_ROOM_RESERVATION_OLTP PRIMARY KEY (RESERVATION_ID);
CREATE SEQUENCE SEQ_ROOM_RESERVATION START WITH 1 INCREMENT BY 1 MAXVALUE 99999 MINVALUE 1 ;

CREATE TABLE ROOM_SLOT_AVLBLTY_LKP
(
VERSION_ID LONG,
ROOM_CAT_ID INTEGER,
SLOT_ID INTEGER,
AVAILABILITY_COUNT INTEGER

);
ALTER TABLE ROOM_SLOT_AVLBLTY_LKP ADD CONSTRAINT PK_ROOM_SLOT_AVLBLTY_LKP PRIMARY KEY (ROOM_CAT_ID,SLOT_ID);



CREATE TABLE USERINFO
(
USER_ID INTEGER,
PASSWORD VARCHAR2(20)

);

ALTER TABLE USERINFO ADD CONSTRAINT PK_USERINFO PRIMARY KEY (USER_ID);



